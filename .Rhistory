rename(realHrac = real1, realSkup = real2) # `nový název` = `starý název`
glimpse(vysledek)
## A takto si můžeme rovnou nechat vyjet pořadí hráčů!
vyhodnoceni = vysledek %>% ungroup() %>% arrange(., desc(soucetSkupiny), desc(celkem)) %>%
select(email, soucetSkupiny, celkem) #%>% filter(!str_detect(email, "fake@"))
vyhodnoceni
## Na přehled vývoje hry asi bude stačit PGG, ale kdyby to bylo potřeba spojit s kontextovými dat,
# tak tady je to všechno spojené
celkova = left_join(PGG, vysledek, by = c("player", "session"))
celkova
## Ještě přidáme datumy do PGG
PGG = left_join(PGG, datumy)
# Vytvoření dat
KA1_kontext = vysledek %>% select(-email)
KA1_pgg = PGG
KA1_spojeno = left_join(KA1_pgg, (KA1_kontext %>% select(-date)), by = c("player", "session"))
# Uložení dat
save(KA1_kontext, KA1_pgg, KA1_spojeno, file = "KA1_vse.RData")
load(file = "KA1_vse.RData")
# Načtení dat z GitHubu
GET("https://github.com/frantisek901/Pavlina/raw/main/KA1_vse.RData",
write_disk("KA1_vse.RData", overwrite = T))
load(file = "KA1_vse.RData")
PGG %>% group_by(stage.round, session) %>% summarise(contribution = mean(contribution)) %>%
ggplot(aes(x = stage.round, y = contribution, col = session)) +
geom_line()
PGG %>% group_by(stage.round) %>% summarise(contribution = mean(contribution)) %>%
ggplot(aes(x = stage.round, y = contribution)) +
geom_line()
ggplot(PGG, aes(x = stage.round, y = contribution, group = session)) +
geom_jitter(col = "blue", alpha = 0.2, size = 2, width = 0, height = 0.3) +  # Individuální pozorování
stat_summary(fun = mean,   # Průměr skupiny za kolo
fun.args = list(mult = 1),
geom = "line",
size = 1.5,
color = "#808080") +
geom_line(data = (PGG %>% group_by(stage.round) %>% mutate(contribution = mean(contribution, na.rm = T))),
aes(x = stage.round, y = contribution),
color = "steelblue",
size = 0.5) +  # Průměr za celý turnaj
facet_wrap(vars(date %>% as.character()), nrow = 3) +  # Rozdělení do panelů podle skupin
guides(color = F) +
labs(caption = "Vysvětlivky:
Tenká modrá čára ukazuje průměrnou investici do společného účtu za kolo za celý turnaj.
Tlustá šedá čára ukazuje průměrnou investici za kolo v příslušné skupině.
Modré body ukazují investice jednotlivých hráčů, které byly celé číslo v intervalu 0--20.
K investicím hráčů je přičten drobný šum (+/- 0.3), aby byl zřetelnější překryv hodnot.
Graf je rozdělený do panelů podle času, kdy skupina dohrála.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
ggplot(PGG, aes(x = stage.round, y = contribution, group = stage.round)) +
geom_jitter(col = "blue", alpha = 0.2, size = 2, width = 0.15, height = 0.35) +  # Individuální pozorování
geom_line(data = (PGG %>% group_by(stage.round) %>% mutate(contribution = mean(contribution, na.rm = T))),
aes(x = stage.round, y = contribution, group = player),
color = "steelblue",
size = 1.5) +  # Průměr za celý turnaj
geom_boxplot(alpha = 0.1, fill = "steelblue", col = "steelblue") +
guides(color = F) +
labs(caption = "Vysvětlivky:
Tlustá modrá čára ukazuje průměrnou investici do společného účtu za kolo za celý turnaj.
Modré box-ploty ukazují celkovou distribuci investic v jednotlivých kolech.
Modré body ukazují investice jednotlivých hráčů, které byly celé číslo v intervalu 0--20.
K investicím hráčů je přičten drobný šum (+/- 0.3), aby byl zřetelnější překryv hodnot.
Graf je rozdělený do panelů podle skupin.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
## Nejdřív je potřeba ynovu vygenerovat vyhodnoceni:
dfv = vysledek %>% ungroup() %>% arrange(., desc(soucetSkupiny), desc(celkem)) %>%
select(email, session, soucetSkupiny, celkem) #%>%
## Teď je potřeba vůbec nadefinovat vektor s odměnami a doplnit 0 na délku `vyhodnoceni`:
odmeny = c(seq(1000, 500, -100), 450, 400, 400, 350, rep(300,3), 250, rep(200, 5), 150,
150, rep(100, 6), rep(50, 16), 25, 25, rep(0, nrow(vyhodnoceni) - 45))
## Tak... Teď připojím `odmeny` jako další proměnnou do `vyhodnoceni` a
# rovnou každému vypočtu jeho odměnu:
# 1) seskupím je podle `soucetSkupiny` a podle `celkem`, tím mi přirozeně vzniknou skupinky,
#    které si budou dělit odměny průměrem (při rovnosti bodů skupiny vytváří `super-skupiny`
#    a uvnitř nich si dělí odměnu rovným dílem hráči se stejným počtem bodů)
# 2) uvnitř skupin daných rovnými body (jak skupin tak hráčů) spočítám průměrné odměny
# 3) když budou body unikátní, zkrátka se replikuje hodnota, když ne, rozdělí se
# 4) využívám toho, že žebříček hráčů a jejich výsledků už je seřazený sestupně, od nejlepší skupiny
#    po nejhorší, a totéž s hráči, když k tomu pak přidám sestupně seřazené odměny, snadno to spočtu
vyhodnoceni = cbind(dfv, 'odmena' = odmeny) %>% group_by(soucetSkupiny, celkem) %>%
mutate(odmena = mean(odmena))
vyhodnoceni
## Tohle jsou asi data, se kterými budete pracovat nejvíc --
# charakteristiky respondentů a jak ovlivňují celkový výsledek
vysledek = left_join(bonus, emaily) %>% left_join(Q1) %>% left_join(Q2, by = c("player", "session")) %>%
left_join(datumy, by = c("session")) %>%
group_by(session) %>% mutate(soucetSkupiny = sum(celkem))  %>%
select(names(.)[1:3], soucetSkupiny, names(.)[4],date, names(.)[5:16], -starts_with("time"), -type) %>% ungroup() %>%
mutate(across(.cols = znajiSe:kooperujeCiz,
.fns = ~(recode(., `7-velmi dobře` = "7", `7-velmi blízký` = "7",
`7-velmi spolupracuji` ="7", `1-vůbec nespolupracuji` = "1",
`1-vůbec` = "1") %>% as.integer())),  # `stará hodnota` = "nová hodnota"
across(.cols = communication:strategy,
.fns = as_factor)) %>%
rename(realHrac = real1, realSkup = real2) # `nový název` = `starý název`
glimpse(vysledek)
ggplot(vysledek, aes(x=date, y=soucetSkupiny)) +
geom_line()
ggplot(vysledek, aes(x=date, y=soucetSkupiny, groups = date)) +
geom_line()
vysledek %>% group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line()
vysledek %>% mutate(date = ymd(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line()
library(lubridate)
vysledek %>% mutate(date = ymd(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line()
class(vysledek$date)
vysledek %>% mutate(date = as.Date(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line()
vysledek %>% mutate(date = as.Date(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line() +
geom_point(data = vysledek)
vysledek %>% mutate(date = as.Date(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line() +
geom_point(data = vysledek, aes(x=date, y=soucetSkupiny))
vysledek %>% mutate(date = as.Date(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line() +
geom_point(data = vysledek, aes(x=date, y=soucetSkupiny)) +
scale_x_datetime()
vysledek %>% mutate(date = as.Date(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line() +
geom_point(data = vysledek, aes(x=date, y=soucetSkupiny)) +
scale_x_date()
vysledek %>% mutate(date = as.Date(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line() +
geom_point(data = (vysledek %>% mutate(date = as.Date(date))), aes(x=date, y=soucetSkupiny))
vysledek %>% mutate(date = as.Date(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line() +
geom_jitter(data = (vysledek %>% mutate(date = as.Date(date))), aes(x=date, y=soucetSkupiny))
vysledek %>% mutate(date = as.Date(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line() +
geom_jitter(data = (vysledek %>% mutate(date = as.Date(date))))
vysledek %>% mutate(date = as.Date(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line() +
geom_jitter(data = vysledek %>% mutate(date = as.Date(date)))
vysledek %>% mutate(date = as.Date(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line() +
geom_jitter(data = vysledek %>% mutate(date = as.Date(date)), size = 3, alpha = 0.1)
vysledek %>% mutate(date = as.Date(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line() +
geom_jitter(data = vysledek %>% mutate(date = as.Date(date)), size = 3, alpha = 0.1, width = 0)
vysledek %>% mutate(date = as.Date(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line() +
geom_jitter(data = vysledek %>% mutate(date = as.Date(date)), aes(x=date, y=celkem * 4)
size = 3, alpha = 0.1, width = 0)
vysledek %>% mutate(date = as.Date(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line() +
geom_jitter(data = vysledek %>% mutate(date = as.Date(date)), aes(x=date, y=(celkem * 4))
size = 3, alpha = 0.1, width = 0)
vysledek %>% mutate(date = as.Date(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line() +
geom_jitter(data = vysledek %>% mutate(date = as.Date(date)), aes(x=date, y=(celkem * 4)),
size = 3, alpha = 0.1, width = 0)
vysledek %>% mutate(date = as.Date(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)/4) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line() +
geom_jitter(data = vysledek %>% mutate(date = as.Date(date)), aes(x=date, y=celkem),
size = 3, alpha = 0.1, width = 0)
vysledek %>% mutate(date = as.Date(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)/4) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line() +
geom_jitter(data = vysledek %>% mutate(date = as.Date(date)), aes(x=date, y=celkem),
size = 3, alpha = 0.1, width = 0.1)
vysledek %>% mutate(date = as.Date(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)/4) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line() +
geom_jitter(data = vysledek %>% mutate(date = as.Date(date)), aes(x=date, y=celkem),
size = 3, alpha = 0.1, width = 0.2)
vysledek %>% mutate(date = as.Date(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)/4) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line() +
geom_jitter(data = vysledek %>% mutate(date = as.Date(date)), aes(x=date, y=celkem),
size = 5, alpha = 0.1, width = 0.2)
vysledek %>% group_by(session) %>% summarise(znajiSe = mean(znajiSe), blizkost = mean(blizkost)) %>%
ggplot(aes(x=znajiSe, y=blizkost)) +
geom_jitter()
vysledek %>% group_by(session, soucetSkupiny) %>% summarise(znajiSe = mean(znajiSe), blizkost = mean(blizkost)) %>%
ggplot(aes(x=znajiSe, y=soucetSkupiny)) +
geom_jitter()
vysledek %>% group_by(session, soucetSkupiny) %>% summarise(znajiSe = mean(znajiSe), blizkost = mean(blizkost)) %>%
ggplot(aes(x=blizkost, y=soucetSkupiny)) +
geom_jitter()
vysledek %>% group_by(session, soucetSkupiny) %>% summarise(znajiSe = mean(znajiSe), blizkost = mean(blizkost)) %>%
ggplot(aes(x=blizkost, y=soucetSkupiny)) +
geom_jitter() +
geom_smooth()
vysledek %>% group_by(session, soucetSkupiny) %>%
summarise(znajiSe = mean(znajiSe, na.rm = T), blizkost = mean(blizkost, na.rm = T)) %>%
ggplot(aes(x=blizkost, y=soucetSkupiny)) +
geom_jitter() +
geom_smooth()
vysledek %>% group_by(session, soucetSkupiny) %>%
summarise(znajiSe = mean(znajiSe, na.rm = T), blizkost = mean(blizkost, na.rm = T)) %>%
ggplot(aes(x=blizkost, y=soucetSkupiny)) +
geom_jitter() +
geom_smooth(stat = "lm")
vysledek %>% group_by(session, soucetSkupiny) %>%
summarise(znajiSe = mean(znajiSe, na.rm = T), blizkost = mean(blizkost, na.rm = T)) %>%
ggplot(aes(x=blizkost, y=soucetSkupiny)) +
geom_jitter() +
geom_smooth(method = "lm")
vysledek %>% group_by(session, soucetSkupiny) %>%
summarise(znajiSe = mean(znajiSe, na.rm = T), blizkost = mean(blizkost, na.rm = T)) %>%
ggplot(aes(x=blizkost, y=soucetSkupiny)) +
geom_jitter(size = 5, alpha = 0.1) +
geom_smooth(method = "lm")
vysledek %>% group_by(session, soucetSkupiny) %>%
summarise(znajiSe = mean(znajiSe, na.rm = T), blizkost = mean(blizkost, na.rm = T)) %>%
ggplot(aes(x=blizkost, y=soucetSkupiny)) +
geom_jitter(size = 5, alpha = 0.3) +
geom_smooth(method = "lm")
vysledek %>% group_by(session, soucetSkupiny) %>%
summarise(znajiSe = mean(znajiSe, na.rm = T), blizkost = mean(blizkost, na.rm = T)) %>%
ggplot(aes(x=znajiSe, y=soucetSkupiny)) +
geom_jitter(size = 5, alpha = 0.3) +
geom_smooth(method = "lm")
vysledek %>% group_by(session, soucetSkupiny) %>%
summarise(znajiSe = mean(znajiSe, na.rm = T), blizkost = mean(blizkost, na.rm = T)) %>%
ggplot(aes(x=blizkost, y=soucetSkupiny)) +
geom_jitter(size = 5, alpha = 0.3) +
geom_smooth(method = "lm")
vysledek %>% group_by(session, soucetSkupiny) %>%
summarise(znajiSe = mean(znajiSe, na.rm = T), blizkost = mean(blizkost, na.rm = T)) %>%
ggplot(aes(x=znajiSe, y=soucetSkupiny)) +
geom_jitter(size = 5, alpha = 0.3) +
geom_smooth(method = "lm")
vysledek %>% group_by(session, soucetSkupiny) %>%
summarise(znajiSe = mean(znajiSe, na.rm = T),
blizkost = mean(blizkost, na.rm = T),
kooperujeKam = mean(kooperujeKam, na.rm = T),
kooperujeCiz = mean(kooperujeCiz, na.rm = T)) %>%
ggplot(aes(x=znajiSe, y=soucetSkupiny)) +
geom_jitter(size = 5, alpha = 0.3) +
geom_smooth(method = "lm")
vysledek %>% group_by(session, soucetSkupiny) %>%
summarise(znajiSe = mean(znajiSe, na.rm = T),
blizkost = mean(blizkost, na.rm = T),
kooperujeKam = mean(kooperujeKam, na.rm = T),
kooperujeCiz = mean(kooperujeCiz, na.rm = T)) %>%
ggplot(aes(x=kooperujeKam, y=soucetSkupiny)) +
geom_jitter(size = 5, alpha = 0.3) +
geom_smooth(method = "lm")
vysledek %>% group_by(session, soucetSkupiny) %>%
summarise(znajiSe = mean(znajiSe, na.rm = T),
blizkost = mean(blizkost, na.rm = T),
kooperujeKam = mean(kooperujeKam, na.rm = T),
kooperujeCiz = mean(kooperujeCiz, na.rm = T)) %>%
ggplot(aes(x=kooperujeCiz, y=soucetSkupiny)) +
geom_jitter(size = 5, alpha = 0.3) +
geom_smooth(method = "lm")
vysledek %>% group_by(session, soucetSkupiny) %>%
summarise(znajiSe = mean(znajiSe, na.rm = T),
blizkost = mean(blizkost, na.rm = T),
kooperujeKam = mean(kooperujeKam, na.rm = T),
kooperujeCiz = mean(kooperujeCiz, na.rm = T)) %>%
ggplot(aes(x=kooperujeKam, y=soucetSkupiny)) +
geom_jitter(size = 5, alpha = 0.3) +
geom_smooth(method = "lm")
vysledek %>% group_by(session, soucetSkupiny) %>%
summarise(znajiSe = mean(znajiSe, na.rm = T), blizkost = mean(blizkost, na.rm = T)) %>%
ggplot(aes(x=blizkost, y=soucetSkupiny)) +
facet_wrap(~communication) +
geom_jitter(size = 5, alpha = 0.3) +
geom_smooth(method = "lm")
vysledek %>% group_by(session, soucetSkupiny) %>%
mutate(znajiSe = mean(znajiSe, na.rm = T), blizkost = mean(blizkost, na.rm = T)) %>%
ggplot(aes(x=blizkost, y=soucetSkupiny)) +
facet_wrap(~communication) +
geom_jitter(size = 5, alpha = 0.3) +
geom_smooth(method = "lm")
vysledek %>% group_by(session, soucetSkupiny) %>%
mutate(znajiSe = mean(znajiSe, na.rm = T),
blizkost = mean(blizkost, na.rm = T),
kooperujeKam = mean(kooperujeKam, na.rm = T),
kooperujeCiz = mean(kooperujeCiz, na.rm = T)) %>%
ggplot(aes(x=znajiSe, y=soucetSkupiny)) +
facet_wrap(~communication) +
geom_jitter(size = 5, alpha = 0.3) +
geom_smooth(method = "lm")
vysledek %>% group_by(session, soucetSkupiny) %>%
mutate(znajiSe = mean(znajiSe, na.rm = T),
blizkost = mean(blizkost, na.rm = T),
kooperujeKam = mean(kooperujeKam, na.rm = T),
kooperujeCiz = mean(kooperujeCiz, na.rm = T)) %>%
ggplot(aes(x=kooperujeKam, y=soucetSkupiny)) +
facet_wrap(~communication) +
geom_jitter(size = 5, alpha = 0.3) +
geom_smooth(method = "lm")
vysledek %>% group_by(session, soucetSkupiny) %>%
mutate(znajiSe = mean(znajiSe, na.rm = T),
blizkost = mean(blizkost, na.rm = T),
kooperujeKam = mean(kooperujeKam, na.rm = T),
kooperujeCiz = mean(kooperujeCiz, na.rm = T)) %>%
ggplot(aes(x=kooperujeCiz, y=soucetSkupiny)) +
facet_wrap(~communication) +
geom_jitter(size = 5, alpha = 0.3) +
geom_smooth(method = "lm")
vysledek %>% group_by(session, soucetSkupiny) %>%
mutate(znajiSe = mean(znajiSe, na.rm = T),
blizkost = mean(blizkost, na.rm = T),
kooperujeKam = mean(kooperujeKam, na.rm = T),
kooperujeCiz = mean(kooperujeCiz, na.rm = T)) %>%
ggplot(aes(x=kooperujeKam, y=soucetSkupiny)) +
facet_wrap(~communication) +
geom_jitter(size = 5, alpha = 0.3) +
geom_smooth(method = "lm")
## Stáhneme data ze serverů
GET('http://207.154.245.100/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData.zip', overwrite = TRUE))
## Získáme seznam souborů ve stažených datech
archive = "aktualniData.zip"
files = unzip(archive, list = T) %>%
filter(Length > 0) %>% filter(str_detect(Name, ".csv") )%>%
filter(!(str_detect(Name, "000015")|  # Příprava na další problematické místnosti, ano třeba 000018...
str_detect(Name, "000018")))  # V místnosti 15 je jen jeden soubor -- vstupní dotazník, jinak nic, jde tedy o nedohranou hru
files
## Na připsání času, kdy hra proběhla si vytvoříme zvláštní soubor
datumy = files[seq(5, nrow(files),5),] %>%
mutate(Name = substr(Name, 6, 15)) %>% select(-Length) %>%
rename(session = Name, date = Date)
datumy
vysledek %>% mutate(date = as.Date(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)/4) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line() +
geom_jitter(data = vysledek %>% mutate(date = as.Date(date)), aes(x=date, y=celkem),
size = 5, alpha = 0.1, width = 0.2)
vysledek %>% group_by(session, soucetSkupiny) %>%
mutate(znajiSe = mean(znajiSe, na.rm = T), blizkost = mean(blizkost, na.rm = T)) %>%
ggplot(aes(x=blizkost, y=soucetSkupiny)) +
facet_wrap(~communication) +
geom_jitter(size = 5, alpha = 0.3) +
geom_smooth(method = "lm")
celkova %>% group_by(player) %>%
mutate(contribution = mean(contribution))
celkova %>% group_by(player) %>%
mutate(contribution = mean(contribution)) %>% filter(stage.round == 1) %>%
ggplot(aes(x=znajiSe, y=contribution)) +
geom_jitter()
celkova %>% group_by(player) %>%
mutate(contribution = mean(contribution)) %>% filter(stage.round == 1) %>%
ggplot(aes(x=znajiSe, y=contribution)) +
geom_jitter() +
scale_x_log10()
celkova %>% group_by(player) %>%
mutate(contribution = mean(contribution)) %>% filter(stage.round == 1) %>%
ggplot(aes(x=znajiSe, y=contribution)) +
geom_jitter() +
scale_x_log10() +
scale_y_log10()
celkova %>% group_by(player) %>%
mutate(contribution = mean(contribution)) %>% filter(stage.round == 1) %>%
ggplot(aes(x=znajiSe, y=contribution)) +
geom_jitter()
celkova %>% group_by(player) %>%
mutate(contribution = mean(contribution)) %>% filter(stage.round == 1) %>%
ggplot(aes(x=blizkost, y=contribution)) +
geom_jitter()
celkova %>% group_by(player) %>%
mutate(contribution = mean(contribution)) %>% filter(stage.round == 1) %>%
ggplot(aes(x=kooperujeKam, y=contribution)) +
geom_jitter()
celkova %>% group_by(player) %>%
mutate(contribution = mean(contribution)) %>% filter(stage.round == 1) %>%
ggplot(aes(x=kooperujeCiz, y=contribution)) +
geom_jitter()
celkova %>% group_by(player) %>%
mutate(contribution = mean(contribution)) %>% filter(stage.round == 1) %>%
ggplot(aes(x=kooperujeCiz, y=contribution)) +
geom_jitter(width = 0.25)
celkova %>% group_by(player) %>%
mutate(contribution = mean(contribution)) %>% filter(stage.round == 1) %>%
ggplot(aes(x=kooperujeKam, y=contribution)) +
geom_jitter(width = 0.25)
celkova %>% group_by(player) %>%
mutate(contribution = mean(contribution)) %>% filter(stage.round == 1) %>%
ggplot(aes(x=znajiSe, y=contribution)) +
geom_jitter(width = 0.25)
celkova %>% group_by(player) %>%
mutate(contribution = mean(contribution)) %>% filter(stage.round == 1) %>%
ggplot(aes(x=blizkost, y=contribution)) +
geom_jitter(width = 0.25)
rt(1,1)^2
## Package
library(dplyr)
library(readr)
library(stringr)
library(httr)
library(ggplot2)
library(forcats)
library(lubridate)
## Stáhneme data ze serverů
GET('http://207.154.245.100/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData.zip', overwrite = TRUE))
## Získáme seznam souborů ve stažených datech
archive = "aktualniData.zip"
files = unzip(archive, list = T) %>%
filter(Length > 0) %>% filter(str_detect(Name, ".csv") )%>%
filter(!(str_detect(Name, "000015")|  # Příprava na další problematické místnosti, ano třeba 000018...
str_detect(Name, "000018")))  # V místnosti 15 je jen jeden soubor -- vstupní dotazník, jinak nic, jde tedy o nedohranou hru
files
## Package
library(dplyr)
library(readr)
library(stringr)
library(httr)
library(ggplot2)
library(forcats)
library(lubridate)
celkova %>% group_by(player) %>%
mutate(contribution = mean(contribution)) %>% filter(stage.round == 1) %>%
ggplot(aes(x=znajiSe, y=contribution)) +
geom_jitter(width = 0.25)
celkova %>% group_by(player) %>%
mutate(contribution = mean(contribution)) %>% filter(stage.round == 1) %>%
ggplot(aes(x=blizkost, y=contribution)) +
geom_jitter(width = 0.25)
PGG %>% group_by(stage.round, session) %>% summarise(contribution = mean(contribution)) %>%
ggplot(aes(x = stage.round, y = contribution, col = session)) +
geom_line()
PGG %>% group_by(stage.round) %>% summarise(contribution = mean(contribution)) %>%
ggplot(aes(x = stage.round, y = contribution)) +
geom_line()
ggplot(PGG, aes(x = stage.round, y = contribution, group = session)) +
geom_jitter(col = "blue", alpha = 0.2, size = 2, width = 0, height = 0.3) +  # Individuální pozorování
stat_summary(fun = mean,   # Průměr skupiny za kolo
fun.args = list(mult = 1),
geom = "line",
size = 1.5,
color = "#808080") +
geom_line(data = (PGG %>% group_by(stage.round) %>% mutate(contribution = mean(contribution, na.rm = T))),
aes(x = stage.round, y = contribution),
color = "steelblue",
size = 0.5) +  # Průměr za celý turnaj
facet_wrap(vars(date %>% as.character()), nrow = 3) +  # Rozdělení do panelů podle skupin
guides(color = F) +
labs(caption = "Vysvětlivky:
Tenká modrá čára ukazuje průměrnou investici do společného účtu za kolo za celý turnaj.
Tlustá šedá čára ukazuje průměrnou investici za kolo v příslušné skupině.
Modré body ukazují investice jednotlivých hráčů, které byly celé číslo v intervalu 0--20.
K investicím hráčů je přičten drobný šum (+/- 0.3), aby byl zřetelnější překryv hodnot.
Graf je rozdělený do panelů podle času, kdy skupina dohrála.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
ggplot(PGG, aes(x = stage.round, y = contribution, group = stage.round)) +
geom_jitter(col = "blue", alpha = 0.2, size = 2, width = 0.15, height = 0.35) +  # Individuální pozorování
geom_line(data = (PGG %>% group_by(stage.round) %>% mutate(contribution = mean(contribution, na.rm = T))),
aes(x = stage.round, y = contribution, group = player),
color = "steelblue",
size = 1.5) +  # Průměr za celý turnaj
geom_boxplot(alpha = 0.1, fill = "steelblue", col = "steelblue") +
guides(color = F) +
labs(caption = "Vysvětlivky:
Tlustá modrá čára ukazuje průměrnou investici do společného účtu za kolo za celý turnaj.
Modré box-ploty ukazují celkovou distribuci investic v jednotlivých kolech.
Modré body ukazují investice jednotlivých hráčů, které byly celé číslo v intervalu 0--20.
K investicím hráčů je přičten drobný šum (+/- 0.3), aby byl zřetelnější překryv hodnot.
Graf je rozdělený do panelů podle skupin.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
vysledek %>% mutate(date = as.Date(date)) %>%  group_by(date) %>% summarise(soucetSkupiny = mean(soucetSkupiny)/4) %>%
ggplot(aes(x=date, y=soucetSkupiny)) +
geom_line() +
geom_jitter(data = vysledek %>% mutate(date = as.Date(date)), aes(x=date, y=celkem),
size = 5, alpha = 0.1, width = 0.2)
vysledek %>% group_by(session, soucetSkupiny) %>%
mutate(znajiSe = mean(znajiSe, na.rm = T), blizkost = mean(blizkost, na.rm = T)) %>%
ggplot(aes(x=blizkost, y=soucetSkupiny)) +
facet_wrap(~communication) +
geom_jitter(size = 5, alpha = 0.3) +
geom_smooth(method = "lm")
vysledek %>% group_by(session, soucetSkupiny) %>%
mutate(znajiSe = mean(znajiSe, na.rm = T),
blizkost = mean(blizkost, na.rm = T),
kooperujeKam = mean(kooperujeKam, na.rm = T),
kooperujeCiz = mean(kooperujeCiz, na.rm = T)) %>%
ggplot(aes(x=znajiSe, y=soucetSkupiny)) +
facet_wrap(~communication) +
geom_jitter(size = 5, alpha = 0.3) +
geom_smooth(method = "lm")
vysledek %>% group_by(session, soucetSkupiny) %>%
mutate(znajiSe = mean(znajiSe, na.rm = T),
blizkost = mean(blizkost, na.rm = T),
kooperujeKam = mean(kooperujeKam, na.rm = T),
kooperujeCiz = mean(kooperujeCiz, na.rm = T)) %>%
ggplot(aes(x=kooperujeKam, y=soucetSkupiny)) +
facet_wrap(~communication) +
geom_jitter(size = 5, alpha = 0.3) +
geom_smooth(method = "lm")
