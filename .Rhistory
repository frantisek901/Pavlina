Graf je rozdělený do panelů podle skupin.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
ggplot(PGG, aes(x = stage.round, y = contribution, group = session)) +
geom_jitter(col = "blue", alpha = 0.2, size = 2, width = 0, height = 0.3) +  # Individuální pozorování
geom_line(data = (PGG %>% group_by(stage.round) %>% mutate(contribution = mean(contribution, na.rm = T))),
aes(x = stage.round, y = contribution),
color = "steelblue",
size = 1.5) +  # Průměr za celý turnaj
guides(color = F) +
labs(caption = "Vysvětlení pro Pavlínu:
Tlustá modrá čára ukazuje průměrnou investici do společného účtu za kolo za celý turnaj.
Tenká šedá čára ukazuje průměrnou investici za kolo v příslušné skupině.
Modré body ukazují investice jednotlivých hráčů, které byly celé číslo v intervalu 0--20.
K investicím hráčů je přičten drobný šum (+/- 0.3), aby byl zřetelnější překryv hodnot.
Graf je rozdělený do panelů podle skupin.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
ggplot(PGG, aes(x = stage.round, y = contribution, group = session)) +
geom_jitter(col = "blue", alpha = 0.2, size = 2, width = 0.15, height = 0.35) +  # Individuální pozorování
geom_line(data = (PGG %>% group_by(stage.round) %>% mutate(contribution = mean(contribution, na.rm = T))),
aes(x = stage.round, y = contribution),
color = "steelblue",
size = 1.5) +  # Průměr za celý turnaj
guides(color = F) +
labs(caption = "Vysvětlení pro Pavlínu:
Tlustá modrá čára ukazuje průměrnou investici do společného účtu za kolo za celý turnaj.
Tenká šedá čára ukazuje průměrnou investici za kolo v příslušné skupině.
Modré body ukazují investice jednotlivých hráčů, které byly celé číslo v intervalu 0--20.
K investicím hráčů je přičten drobný šum (+/- 0.3), aby byl zřetelnější překryv hodnot.
Graf je rozdělený do panelů podle skupin.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
ggplot(PGG, aes(x = stage.round, y = contribution, group = stage.round)) +
geom_jitter(col = "blue", alpha = 0.2, size = 2, width = 0.15, height = 0.35) +  # Individuální pozorování
geom_line(data = (PGG %>% group_by(stage.round) %>% mutate(contribution = mean(contribution, na.rm = T))),
aes(x = stage.round, y = contribution),
color = "steelblue",
size = 1.5) +  # Průměr za celý turnaj
guides(color = F) +
labs(caption = "Vysvětlení pro Pavlínu:
Tlustá modrá čára ukazuje průměrnou investici do společného účtu za kolo za celý turnaj.
Tenká šedá čára ukazuje průměrnou investici za kolo v příslušné skupině.
Modré body ukazují investice jednotlivých hráčů, které byly celé číslo v intervalu 0--20.
K investicím hráčů je přičten drobný šum (+/- 0.3), aby byl zřetelnější překryv hodnot.
Graf je rozdělený do panelů podle skupin.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
ggplot(PGG, aes(x = stage.round, y = contribution, group = stage.round)) +
geom_jitter(col = "blue", alpha = 0.2, size = 2, width = 0.15, height = 0.35) +  # Individuální pozorování
geom_line(data = (PGG %>% group_by(stage.round) %>% mutate(contribution = mean(contribution, na.rm = T))),
aes(x = stage.round, y = contribution),
color = "steelblue",
size = 1.5) +  # Průměr za celý turnaj
geom_boxplot() +
guides(color = F) +
labs(caption = "Vysvětlení pro Pavlínu:
Tlustá modrá čára ukazuje průměrnou investici do společného účtu za kolo za celý turnaj.
Tenká šedá čára ukazuje průměrnou investici za kolo v příslušné skupině.
Modré body ukazují investice jednotlivých hráčů, které byly celé číslo v intervalu 0--20.
K investicím hráčů je přičten drobný šum (+/- 0.3), aby byl zřetelnější překryv hodnot.
Graf je rozdělený do panelů podle skupin.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
ggplot(PGG, aes(x = stage.round, y = contribution, group = stage.round)) +
geom_jitter(col = "blue", alpha = 0.2, size = 2, width = 0.15, height = 0.35) +  # Individuální pozorování
geom_line(data = (PGG %>% group_by(stage.round) %>% mutate(contribution = mean(contribution, na.rm = T))),
aes(x = stage.round, y = contribution),
color = "steelblue",
size = 1.5) +  # Průměr za celý turnaj
geom_boxplot(alpha = 0.1, fill = "steelblue", col = "steelblue") +
guides(color = F) +
labs(caption = "Vysvětlení pro Pavlínu:
Tlustá modrá čára ukazuje průměrnou investici do společného účtu za kolo za celý turnaj.
Tenká šedá čára ukazuje průměrnou investici za kolo v příslušné skupině.
Modré body ukazují investice jednotlivých hráčů, které byly celé číslo v intervalu 0--20.
K investicím hráčů je přičten drobný šum (+/- 0.3), aby byl zřetelnější překryv hodnot.
Graf je rozdělený do panelů podle skupin.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
ggplot(PGG, aes(x = stage.round, y = contribution, group = stage.round)) +
geom_jitter(col = "blue", alpha = 0.2, size = 2, width = 0.15, height = 0.35) +  # Individuální pozorování
geom_line(data = (PGG %>% group_by(stage.round) %>% mutate(contribution = mean(contribution, na.rm = T))),
aes(x = stage.round, y = contribution, group = player),
color = "steelblue",
size = 1.5) +  # Průměr za celý turnaj
geom_boxplot(alpha = 0.1, fill = "steelblue", col = "steelblue") +
guides(color = F) +
labs(caption = "Vysvětlení pro Pavlínu:
Tlustá modrá čára ukazuje průměrnou investici do společného účtu za kolo za celý turnaj.
Tenká šedá čára ukazuje průměrnou investici za kolo v příslušné skupině.
Modré body ukazují investice jednotlivých hráčů, které byly celé číslo v intervalu 0--20.
K investicím hráčů je přičten drobný šum (+/- 0.3), aby byl zřetelnější překryv hodnot.
Graf je rozdělený do panelů podle skupin.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
ggplot(PGG, aes(x = stage.round, y = contribution, group = stage.round)) +
geom_jitter(col = "blue", alpha = 0.2, size = 2, width = 0.15, height = 0.35) +  # Individuální pozorování
geom_line(data = (PGG %>% group_by(stage.round) %>% mutate(contribution = mean(contribution, na.rm = T))),
aes(x = stage.round, y = contribution, group = player),
color = "steelblue",
size = 1.5) +  # Průměr za celý turnaj
geom_boxplot(alpha = 0.1, fill = "steelblue", col = "steelblue") +
guides(color = F) +
labs(caption = "Vysvětlení pro Pavlínu:
Tlustá modrá čára ukazuje průměrnou investici do společného účtu za kolo za celý turnaj.
Modré box-ploty ukazují celkovou distribuci investic v jednotlivých kolech.
Modré body ukazují investice jednotlivých hráčů, které byly celé číslo v intervalu 0--20.
K investicím hráčů je přičten drobný šum (+/- 0.3), aby byl zřetelnější překryv hodnot.
Graf je rozdělený do panelů podle skupin.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
GET('http://207.154.245.100/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData.zip', overwrite = TRUE))
archive = "aktualniData.zip"
files = unzip(archive, list = T) %>%
filter(Length > 0) %>% filter(str_detect(Name, ".csv") )%>%
filter(!(str_detect(Name, "000015")|  # Příprava na další problematické místnosti, ano třeba 000018...
str_detect(Name, "000018")))  # V místnosti 15 je jen jeden soubor -- vstupní dotazník, jinak nic, jde tedy o nedohranou hru
files
ggplot(PGG, aes(x = stage.round, y = contribution, group = session)) +
geom_jitter(col = "blue", alpha = 0.2, size = 2, width = 0, height = 0.3) +  # Individuální pozorování
stat_summary(fun = mean,   # Průměr skupiny za kolo
fun.args = list(mult = 1),
geom = "line",
size = 1.5,
color = "#808080") +
geom_line(data = (PGG %>% group_by(stage.round) %>% mutate(contribution = mean(contribution, na.rm = T))),
aes(x = stage.round, y = contribution),
color = "steelblue",
size = 0.5) +  # Průměr za celý turnaj
facet_wrap(vars(session), nrow = 3) +  # Rozdělení do panelů podle skupin
guides(color = F) +
labs(caption = "Vysvětlení pro Pavlínu:
Tenká modrá čára ukazuje průměrnou investici do společného účtu za kolo za celý turnaj.
Tlustá šedá čára ukazuje průměrnou investici za kolo v příslušné skupině.
Modré body ukazují investice jednotlivých hráčů, které byly celé číslo v intervalu 0--20.
K investicím hráčů je přičten drobný šum (+/- 0.3), aby byl zřetelnější překryv hodnot.
Graf je rozdělený do panelů podle skupin.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
GET('http://207.154.245.100/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData.zip', overwrite = TRUE))
GET('http://207.154.245.100/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData.zip', overwrite = TRUE))
archive = "aktualniData.zip"
files = unzip(archive, list = T) %>%
filter(Length > 0) %>% filter(str_detect(Name, ".csv") )%>%
filter(!(str_detect(Name, "000015")|  # Příprava na další problematické místnosti, ano třeba 000018...
str_detect(Name, "000018")))  # V místnosti 15 je jen jeden soubor -- vstupní dotazník, jinak nic, jde tedy o nedohranou hru
files
ggplot(PGG, aes(x = stage.round, y = contribution, group = stage.round)) +
geom_jitter(col = "blue", alpha = 0.2, size = 2, width = 0.15, height = 0.35) +  # Individuální pozorování
geom_line(data = (PGG %>% group_by(stage.round) %>% mutate(contribution = mean(contribution, na.rm = T))),
aes(x = stage.round, y = contribution, group = player),
color = "steelblue",
size = 1.5) +  # Průměr za celý turnaj
geom_boxplot(alpha = 0.1, fill = "steelblue", col = "steelblue") +
guides(color = F) +
labs(caption = "Vysvětlení pro Pavlínu:
Tlustá modrá čára ukazuje průměrnou investici do společného účtu za kolo za celý turnaj.
Modré box-ploty ukazují celkovou distribuci investic v jednotlivých kolech.
Modré body ukazují investice jednotlivých hráčů, které byly celé číslo v intervalu 0--20.
K investicím hráčů je přičten drobný šum (+/- 0.3), aby byl zřetelnější překryv hodnot.
Graf je rozdělený do panelů podle skupin.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
ggplot(PGG, aes(x = stage.round, y = contribution, group = stage.round)) +
geom_jitter(col = "blue", alpha = 0.2, size = 2, width = 0.15, height = 0.35) +  # Individuální pozorování
geom_line(data = (PGG %>% group_by(stage.round) %>% mutate(contribution = mean(contribution, na.rm = T))),
aes(x = stage.round, y = contribution, group = player),
color = "steelblue",
size = 1.5) +  # Průměr za celý turnaj
geom_violin(alpha = 0.1, fill = "steelblue", col = "steelblue") +
guides(color = F) +
labs(caption = "Vysvětlení pro Pavlínu:
Tlustá modrá čára ukazuje průměrnou investici do společného účtu za kolo za celý turnaj.
Modré box-ploty ukazují celkovou distribuci investic v jednotlivých kolech.
Modré body ukazují investice jednotlivých hráčů, které byly celé číslo v intervalu 0--20.
K investicím hráčů je přičten drobný šum (+/- 0.3), aby byl zřetelnější překryv hodnot.
Graf je rozdělený do panelů podle skupin.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
ggplot(PGG, aes(x = stage.round, y = contribution, group = stage.round)) +
geom_jitter(col = "blue", alpha = 0.2, size = 2, width = 0.15, height = 0.35) +  # Individuální pozorování
geom_line(data = (PGG %>% group_by(stage.round) %>% mutate(contribution = mean(contribution, na.rm = T))),
aes(x = stage.round, y = contribution, group = player),
color = "steelblue",
size = 1.5) +  # Průměr za celý turnaj
geom_boxplot(alpha = 0.1, fill = "steelblue", col = "steelblue") +
guides(color = F) +
labs(caption = "Vysvětlení pro Pavlínu:
Tlustá modrá čára ukazuje průměrnou investici do společného účtu za kolo za celý turnaj.
Modré box-ploty ukazují celkovou distribuci investic v jednotlivých kolech.
Modré body ukazují investice jednotlivých hráčů, které byly celé číslo v intervalu 0--20.
K investicím hráčů je přičten drobný šum (+/- 0.3), aby byl zřetelnější překryv hodnot.
Graf je rozdělený do panelů podle skupin.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
## Hlavička
rm(list = ls())
## Package
library(dplyr)
library(readr)
library(stringr)
library(httr)
library(ggplot2)
library(forcats)
GET('http://207.154.245.100/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData.zip', overwrite = TRUE))
archive = "aktualniData.zip"
files = unzip(archive, list = T) %>%
filter(Length > 0) %>% filter(str_detect(Name, ".csv") )%>%
filter(!(str_detect(Name, "000015")|  # Příprava na další problematické místnosti, ano třeba 000018...
str_detect(Name, "000018")))  # V místnosti 15 je jen jeden soubor -- vstupní dotazník, jinak nic, jde tedy o nedohranou hru
files
bonus = unz(archive, files$Name[1]) %>% read_csv() %>% rename(player = id, celkem = bonus)
emaily = unz(archive, files$Name[2]) %>% read_csv() %>% rename(email = value)
PGG = unz(archive, files$Name[3]) %>% read_csv()
Q1 = unz(archive, files$Name[4]) %>% read_csv()
Q2 = unz(archive, files$Name[5]) %>% read_csv()
for (f in 1:(nrow(files)/5 - 1)) {
bonus = unz(archive, files$Name[f*5 + 1]) %>% read_csv() %>%
rename(player = id, celkem = bonus) %>% rbind(bonus, .)
emaily = unz(archive, files$Name[f*5 + 2]) %>% read_csv() %>%
rename(email = value) %>% rbind(emaily, .)
PGG = unz(archive, files$Name[f*5 + 3]) %>% read_csv() %>% rbind(PGG, .)
Q1 = unz(archive, files$Name[f*5 + 4]) %>% read_csv() %>% rbind(Q1, .)
Q2 = unz(archive, files$Name[f*5 + 5]) %>% read_csv() %>% rbind(Q2, .)
}
## Tohle jsou asi data, se kterými budete pracovat nejvíc --
# charakteristiky respondentů a jak ovlivňují celkový výsledek
vysledek = left_join(bonus, emaily) %>% left_join(Q1) %>% left_join(Q2, by = c("player", "session")) %>%
group_by(session) %>% mutate(soucetSkupiny = sum(celkem))  %>%
select(names(.)[1:3], soucetSkupiny, names(.)[4:16], -starts_with("time"), -type) %>% ungroup() %>%
mutate(across(.cols = znajiSe:kooperujeCiz,
.fns = ~(recode(., `7-velmi dobře` = "7", `7-velmi blízký` = "7",
`7-velmi spolupracuji` ="7", `1-vůbec nespolupracuji` = "1",
`1-vůbec` = "1") %>% as.integer())),  # `stará hodnota` = "nová hodnota"
across(.cols = communication:strategy,
.fns = as_factor)) %>%
rename(realHrac = real1, realSkup = real2) # `nový název` = `starý název`
glimpse(vysledek)
## A takto si můžeme rovnou nechat vyjet pořadí hráčů!
vyhodnoceni = vysledek %>% ungroup() %>% arrange(., desc(soucetSkupiny), desc(celkem)) %>%
select(email, soucetSkupiny, celkem) #%>% filter(!str_detect(email, "fake@"))
vyhodnoceni
## Na přehled vývoje hry asi bude stačit PGG, ale kdyby to bylo potřeba spojit s kontextovými dat,
# tak tady je to všechno spojené
celkova = left_join(PGG, vysledek, by = c("player", "session"))
celkova
vyhodnoceni
# Vytvoření dat
KA1_kontext = vysledek %>% select(-email)
KA1_pgg = PGG
KA1_spojeno = left_join(KA1_pgg, KA1_kontext, by = c("player", "session"))
# Načtení dat z GitHubu
GET("https://github.com/frantisek901/Pavlina/raw/main/KA1_vse.RData",
write_disk("KA1_vse.RData", overwrite = T))
load(file = "KA1_vse.RData")
# ## Vývojový graf --------------------------------------------------------
ggplot(PGG, aes(x = stage.round, y = contribution, col = as.factor(player))) +
geom_line()
# ## Vývojový graf --------------------------------------------------------
PGG %>% group_by(stage.round, session) %>% summarise(contribution = mean(contribution)) %>%
ggplot(aes(x = stage.round, y = contribution, col = session)) +
geom_line()
PGG %>% group_by(stage.round) %>% summarise(contribution = mean(contribution)) %>%
ggplot(aes(x = stage.round, y = contribution)) +
geom_line()
ggplot(PGG, aes(x = stage.round, y = contribution, group = session)) +
geom_jitter(col = "blue", alpha = 0.2, size = 2, width = 0, height = 0.3) +  # Individuální pozorování
stat_summary(fun = mean,   # Průměr skupiny za kolo
fun.args = list(mult = 1),
geom = "line",
size = 1.5,
color = "#808080") +
geom_line(data = (PGG %>% group_by(stage.round) %>% mutate(contribution = mean(contribution, na.rm = T))),
aes(x = stage.round, y = contribution),
color = "steelblue",
size = 0.5) +  # Průměr za celý turnaj
facet_wrap(vars(session), nrow = 3) +  # Rozdělení do panelů podle skupin
guides(color = F) +
labs(caption = "Vysvětlení pro Pavlínu:
Tenká modrá čára ukazuje průměrnou investici do společného účtu za kolo za celý turnaj.
Tlustá šedá čára ukazuje průměrnou investici za kolo v příslušné skupině.
Modré body ukazují investice jednotlivých hráčů, které byly celé číslo v intervalu 0--20.
K investicím hráčů je přičten drobný šum (+/- 0.3), aby byl zřetelnější překryv hodnot.
Graf je rozdělený do panelů podle skupin.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
ggplot(PGG, aes(x = stage.round, y = contribution, group = stage.round)) +
geom_jitter(col = "blue", alpha = 0.2, size = 2, width = 0.15, height = 0.35) +  # Individuální pozorování
geom_line(data = (PGG %>% group_by(stage.round) %>% mutate(contribution = mean(contribution, na.rm = T))),
aes(x = stage.round, y = contribution, group = player),
color = "steelblue",
size = 1.5) +  # Průměr za celý turnaj
geom_boxplot(alpha = 0.1, fill = "steelblue", col = "steelblue") +
guides(color = F) +
labs(caption = "Vysvětlení pro Pavlínu:
Tlustá modrá čára ukazuje průměrnou investici do společného účtu za kolo za celý turnaj.
Modré box-ploty ukazují celkovou distribuci investic v jednotlivých kolech.
Modré body ukazují investice jednotlivých hráčů, které byly celé číslo v intervalu 0--20.
K investicím hráčů je přičten drobný šum (+/- 0.3), aby byl zřetelnější překryv hodnot.
Graf je rozdělený do panelů podle skupin.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
GET('http://207.154.245.100/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData.zip', overwrite = TRUE))
GET('http://207.154.245.100/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData.zip', overwrite = TRUE))
GET('http://207.154.245.100/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData.zip', overwrite = TRUE))
## Hlavička
rm(list = ls())
## Package
library(dplyr)
library(readr)
library(stringr)
library(httr)
library(ggplot2)
library(forcats)
GET('http://207.154.245.100/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData.zip', overwrite = TRUE))
GET('http://134.122.66.93/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData2.zip', overwrite = TRUE))
## Hlavička
rm(list = ls())
## Package
library(dplyr)
library(readr)
library(stringr)
library(httr)
library(ggplot2)
library(forcats)
GET('http://207.154.245.100/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData.zip', overwrite = TRUE))
GET('http://134.122.66.93/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData2.zip', overwrite = TRUE))
GET('http://207.154.245.100/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData.zip', overwrite = TRUE))
GET('http://134.122.66.93/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData2.zip', overwrite = TRUE))
## Hlavička
rm(list = ls())
## Package
library(dplyr)
library(readr)
library(stringr)
library(httr)
library(ggplot2)
library(forcats)
GET('http://207.154.245.100/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData.zip', overwrite = TRUE))
GET('http://134.122.66.93/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData2.zip', overwrite = TRUE))
GET('http://207.154.245.100/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData.zip', overwrite = TRUE))
library(httr)
GET('http://207.154.245.100/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData.zip', overwrite = TRUE))
install.packages(c("bayestestR", "benchmarkme", "bitops", "bridgesampling", "brio", "broom", "callr", "caTools", "cli", "correlation", "corrgram", "cpp11", "dbplyr", "DescTools", "devtools", "diffobj", "DT", "e1071", "effectsize", "ellipsis", "esquisse", "formatR", "gargle", "gert", "ggstatsplot", "gh", "gifski", "haven", "highr", "httpuv", "insight", "jquerylib", "knitr", "later", "mc2d", "multcomp", "OpenMx", "pairwiseComparisons", "parameters", "performance", "pillar", "pkgload", "processx", "psych", "rcompanion", "RcppArmadillo", "RcppParallel", "RCurl", "remotes", "reprex", "reticulate", "rJava", "Rmpfr", "rpf", "RPostgres", "runner", "statsExpressions", "tibble", "tidyverse", "tinytex", "TMB", "tweenr", "V8", "vctrs", "viridis", "viridisLite", "withr", "writexl", "XLConnect", "XML"))
install.packages("tidyselect")
GET('http://207.154.245.100/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData.zip', overwrite = TRUE))
archive = "aktualniData.zip"
files = unzip(archive, list = T) %>%
filter(Length > 0) %>% filter(str_detect(Name, ".csv") )%>%
filter(!(str_detect(Name, "000015")|  # Příprava na další problematické místnosti, ano třeba 000018...
str_detect(Name, "000018")))  # V místnosti 15 je jen jeden soubor -- vstupní dotazník, jinak nic, jde tedy o nedohranou hru
## Package
library(dplyr)
library(readr)
library(stringr)
library(httr)
library(ggplot2)
library(forcats)
GET('http://207.154.245.100/pgg/monitor/data/*',  ## Adresa naší hry
write_disk('aktualniData.zip', overwrite = TRUE))
archive = "aktualniData.zip"
files = unzip(archive, list = T) %>%
filter(Length > 0) %>% filter(str_detect(Name, ".csv") )%>%
filter(!(str_detect(Name, "000015")|  # Příprava na další problematické místnosti, ano třeba 000018...
str_detect(Name, "000018")))  # V místnosti 15 je jen jeden soubor -- vstupní dotazník, jinak nic, jde tedy o nedohranou hru
files
bonus = unz(archive, files$Name[1]) %>% read_csv() %>% rename(player = id, celkem = bonus)
emaily = unz(archive, files$Name[2]) %>% read_csv() %>% rename(email = value)
PGG = unz(archive, files$Name[3]) %>% read_csv()
Q1 = unz(archive, files$Name[4]) %>% read_csv()
Q2 = unz(archive, files$Name[5]) %>% read_csv()
for (f in 1:(nrow(files)/5 - 1)) {
bonus = unz(archive, files$Name[f*5 + 1]) %>% read_csv() %>%
rename(player = id, celkem = bonus) %>% rbind(bonus, .)
emaily = unz(archive, files$Name[f*5 + 2]) %>% read_csv() %>%
rename(email = value) %>% rbind(emaily, .)
PGG = unz(archive, files$Name[f*5 + 3]) %>% read_csv() %>% rbind(PGG, .)
Q1 = unz(archive, files$Name[f*5 + 4]) %>% read_csv() %>% rbind(Q1, .)
Q2 = unz(archive, files$Name[f*5 + 5]) %>% read_csv() %>% rbind(Q2, .)
}
## Tohle jsou asi data, se kterými budete pracovat nejvíc --
# charakteristiky respondentů a jak ovlivňují celkový výsledek
vysledek = left_join(bonus, emaily) %>% left_join(Q1) %>% left_join(Q2, by = c("player", "session")) %>%
group_by(session) %>% mutate(soucetSkupiny = sum(celkem))  %>%
select(names(.)[1:3], soucetSkupiny, names(.)[4:16], -starts_with("time"), -type) %>% ungroup() %>%
mutate(across(.cols = znajiSe:kooperujeCiz,
.fns = ~(recode(., `7-velmi dobře` = "7", `7-velmi blízký` = "7",
`7-velmi spolupracuji` ="7", `1-vůbec nespolupracuji` = "1",
`1-vůbec` = "1") %>% as.integer())),  # `stará hodnota` = "nová hodnota"
across(.cols = communication:strategy,
.fns = as_factor)) %>%
rename(realHrac = real1, realSkup = real2) # `nový název` = `starý název`
glimpse(vysledek)
## A takto si můžeme rovnou nechat vyjet pořadí hráčů!
vyhodnoceni = vysledek %>% ungroup() %>% arrange(., desc(soucetSkupiny), desc(celkem)) %>%
select(email, soucetSkupiny, celkem) #%>% filter(!str_detect(email, "fake@"))
vyhodnoceni
## Na přehled vývoje hry asi bude stačit PGG, ale kdyby to bylo potřeba spojit s kontextovými dat,
# tak tady je to všechno spojené
celkova = left_join(PGG, vysledek, by = c("player", "session"))
celkova
# Vytvoření dat
KA1_kontext = vysledek %>% select(-email)
KA1_pgg = PGG
KA1_spojeno = left_join(KA1_pgg, KA1_kontext, by = c("player", "session"))
# Uložení dat
save(KA1_kontext, KA1_pgg, KA1_spojeno, file = "KA1_vse.RData")
load(file = "KA1_vse.RData")
# Načtení dat z GitHubu
GET("https://github.com/frantisek901/Pavlina/raw/main/KA1_vse.RData",
write_disk("KA1_vse.RData", overwrite = T))
load(file = "KA1_vse.RData")
PGG %>% group_by(stage.round, session) %>% summarise(contribution = mean(contribution)) %>%
ggplot(aes(x = stage.round, y = contribution, col = session)) +
geom_line()
PGG %>% group_by(stage.round) %>% summarise(contribution = mean(contribution)) %>%
ggplot(aes(x = stage.round, y = contribution)) +
geom_line()
ggplot(PGG, aes(x = stage.round, y = contribution, group = session)) +
geom_jitter(col = "blue", alpha = 0.2, size = 2, width = 0, height = 0.3) +  # Individuální pozorování
stat_summary(fun = mean,   # Průměr skupiny za kolo
fun.args = list(mult = 1),
geom = "line",
size = 1.5,
color = "#808080") +
geom_line(data = (PGG %>% group_by(stage.round) %>% mutate(contribution = mean(contribution, na.rm = T))),
aes(x = stage.round, y = contribution),
color = "steelblue",
size = 0.5) +  # Průměr za celý turnaj
facet_wrap(vars(session), nrow = 3) +  # Rozdělení do panelů podle skupin
guides(color = F) +
labs(caption = "Vysvětlení pro Pavlínu:
Tenká modrá čára ukazuje průměrnou investici do společného účtu za kolo za celý turnaj.
Tlustá šedá čára ukazuje průměrnou investici za kolo v příslušné skupině.
Modré body ukazují investice jednotlivých hráčů, které byly celé číslo v intervalu 0--20.
K investicím hráčů je přičten drobný šum (+/- 0.3), aby byl zřetelnější překryv hodnot.
Graf je rozdělený do panelů podle skupin.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
ggplot(PGG, aes(x = stage.round, y = contribution, group = stage.round)) +
geom_jitter(col = "blue", alpha = 0.2, size = 2, width = 0.15, height = 0.35) +  # Individuální pozorování
geom_line(data = (PGG %>% group_by(stage.round) %>% mutate(contribution = mean(contribution, na.rm = T))),
aes(x = stage.round, y = contribution, group = player),
color = "steelblue",
size = 1.5) +  # Průměr za celý turnaj
geom_boxplot(alpha = 0.1, fill = "steelblue", col = "steelblue") +
guides(color = F) +
labs(caption = "Vysvětlení pro Pavlínu:
Tlustá modrá čára ukazuje průměrnou investici do společného účtu za kolo za celý turnaj.
Modré box-ploty ukazují celkovou distribuci investic v jednotlivých kolech.
Modré body ukazují investice jednotlivých hráčů, které byly celé číslo v intervalu 0--20.
K investicím hráčů je přičten drobný šum (+/- 0.3), aby byl zřetelnější překryv hodnot.
Graf je rozdělený do panelů podle skupin.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
ggplot(PGG, aes(x = stage.round, y = contribution, group = session)) +
geom_jitter(col = "blue", alpha = 0.2, size = 2, width = 0, height = 0.3) +  # Individuální pozorování
stat_summary(fun = mean,   # Průměr skupiny za kolo
fun.args = list(mult = 1),
geom = "line",
size = 1.5,
color = "#808080") +
geom_line(data = (PGG %>% group_by(stage.round) %>% mutate(contribution = mean(contribution, na.rm = T))),
aes(x = stage.round, y = contribution),
color = "steelblue",
size = 0.5) +  # Průměr za celý turnaj
facet_wrap(vars(session), nrow = 3) +  # Rozdělení do panelů podle skupin
guides(color = F) +
labs(caption = "Vysvětlení pro Pavlínu:
Tenká modrá čára ukazuje průměrnou investici do společného účtu za kolo za celý turnaj.
Tlustá šedá čára ukazuje průměrnou investici za kolo v příslušné skupině.
Modré body ukazují investice jednotlivých hráčů, které byly celé číslo v intervalu 0--20.
K investicím hráčů je přičten drobný šum (+/- 0.3), aby byl zřetelnější překryv hodnot.
Graf je rozdělený do panelů podle skupin.") +
theme_minimal() +
scale_x_continuous(breaks = seq(0, 10, 2)) +
scale_y_continuous(breaks = seq(0, 20, 2))
